# uninstall --help shows usage
exec dh uninstall --help
stdout 'dh uninstall'
stdout '\-\-force'
! stderr .

# uninstall nonexistent version fails
! exec dh uninstall 99.99.99 --force
stderr 'not installed'

# uninstall --force removes version directory
mkdir $DH_HOME/versions/0.36.0
cp meta.toml $DH_HOME/versions/0.36.0/meta.toml
exec dh uninstall 0.36.0 --force
stdout 'Uninstalled Deephaven 0\.36\.0'
! exists $DH_HOME/versions/0.36.0

# uninstall --force --json returns structured output
mkdir $DH_HOME/versions/0.37.0
cp meta.toml $DH_HOME/versions/0.37.0/meta.toml
exec dh uninstall 0.37.0 --force --json
stdout '"version": "0.37.0"'
stdout '"status": "uninstalled"'

-- meta.toml --
installed_at = 2024-01-15T10:30:00Z
